import re
from sklearn.feature_extraction.text import CountVectorizer
from sklearn.naive_bayes import MultinomialNB

# Função de pré-processamento
def limpar_texto(texto):
    texto = texto.lower()  # Converte para minúsculas
    texto = re.sub(r'[^\w\s]', '', texto)  # Remove pontuação
    texto = re.sub(r'\d+', '', texto)  # Remove números
    texto = texto.strip()  # Remove espaços extras
    return texto

# 1. Conjunto de dados (mensagens + rótulos)
mensagens = [
    "Quanto custa a matrícula da academia?",
    "Quero falar com alguém sobre meu plano",
    "Quais promoções vocês têm esse mês?",
    "Qual o horário de funcionamento nos feriados?",
    "A esteira quebrou no meio do treino",
    "Posso pagar com pix ou cartão?",
    "O vestiário estava sujo hoje",
    "Adorei a aula de spinning de hoje!",
    "Quero cancelar meu plano",
    "Como faço para me inscrever na avaliação física?"
]

rotulos = ["financeiro","suporte","promoção","informação","manutenção"
,"pagamento","reclamação","elogio","cancelamento","cadastro"]



# 2. Pré-processamento das mensagens
mensagens_limpas = [limpar_texto(m) for m in mensagens]

# 3. Vetorização
vectorizer = CountVectorizer()
X = vectorizer.fit_transform(mensagens_limpas)

# 4. Treinamento do modelo
modelo = MultinomialNB()
modelo.fit(X, rotulos)

# 5. Interação com o usuário
while True:
    nova_mensagem = input("\nDigite uma mensagem (ou 'sair' para encerrar): ")
    if nova_mensagem.lower() == "sair":
        break
    nova_mensagem_limpa = limpar_texto(nova_mensagem)
    X_novo = vectorizer.transform([nova_mensagem_limpa])
    predicao = modelo.predict(X_novo)
    print(f"Intenção prevista: {predicao[0]}")
